(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[192],{2494:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile/[id]",function(){return n(8258)}])},9135:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(5893),s=n(7294),a=n(1822);function l(e){let{profileId:t,onUpload:n}=e,l=(0,s.useRef)(),[i,o]=(0,s.useState)(!1),[c,u]=(0,s.useState)(""),f=async e=>{let r=e.target.files[0];if(r){o(!0),u("");try{let e="".concat(t,"_").concat(Date.now());await (0,a.gg)(r,e);let s=(0,a.E$)(e);n(s)}catch(e){u("Errore upload foto")}finally{o(!1)}}};return(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,r.jsx)("input",{type:"file",accept:"image/*",ref:l,onChange:f,className:"hidden"}),(0,r.jsx)("button",{className:"px-3 py-1 bg-primary text-white rounded shadow hover:bg-primary/80",onClick:()=>l.current.click(),disabled:i,type:"button",children:i?"Caricamento...":"Carica foto profilo"}),c&&(0,r.jsx)("span",{className:"text-red-500 text-xs",children:c})]})}},8258:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(5893),s=n(7294),a=n(1163),l=n(1822);function i(){let{id:e}=(0,a.useRouter)().query,[t,n]=(0,s.useState)(null),[i,o]=(0,s.useState)([]),[c,u]=(0,s.useState)(!0),[f,d]=(0,s.useState)(""),[p,x]=(0,s.useState)(""),[m,h]=(0,s.useState)("");(0,s.useEffect)(()=>{e&&((0,l.cp)().then(t=>{n(t.find(t=>t.id==e))}),(0,l.T4)().then(t=>{o(t.filter(t=>t.profile_id==e))}).finally(()=>u(!1)))},[e]);let g=async t=>{if(t.preventDefault(),f&&p)try{let t=await (0,l.Fl)({desc:f,amount:parseFloat(p),profile_id:e,date:new Date().toISOString()});o([t,...i]),d(""),x("")}catch(e){h("Errore salvataggio spesa")}};return c?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:"Caricamento..."}):t?(0,r.jsx)("main",{className:"min-h-screen flex flex-col items-center justify-center bg-background px-4 py-8",children:(0,r.jsxs)("div",{className:"w-full max-w-md mx-auto bg-white rounded-xl shadow p-6 flex flex-col gap-6",children:[(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,r.jsx)("img",{src:t.avatar_url||"/avatar1.png",alt:t.name,className:"w-24 h-24 rounded-full object-cover border"}),(0,r.jsx)("h2",{className:"text-2xl font-bold",children:t.name})]}),(0,r.jsxs)("form",{onSubmit:g,className:"flex flex-col gap-3",children:[(0,r.jsx)("input",{type:"text",placeholder:"Descrizione",value:f,onChange:e=>d(e.target.value),className:"border rounded px-4 py-2 w-full focus:outline-none focus:ring focus:border-blue-400",required:!0}),(0,r.jsx)("input",{type:"number",min:"0",step:"0.01",placeholder:"Importo (€)",value:p,onChange:e=>x(e.target.value),className:"border rounded px-4 py-2 w-full focus:outline-none focus:ring focus:border-blue-400",required:!0}),(0,r.jsx)("button",{type:"submit",className:"w-full py-2 rounded-xl bg-primary text-white font-bold text-lg shadow hover:bg-primary/90 transition",children:"Aggiungi spesa"})]}),m&&(0,r.jsx)("div",{className:"text-center text-red-500",children:m}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Le tue spese"}),(0,r.jsx)("ul",{className:"flex flex-col gap-2",children:i.map(e=>(0,r.jsxs)("li",{className:"flex justify-between items-center bg-gray-100 rounded-lg px-3 py-2",children:[(0,r.jsx)("span",{children:e.desc}),(0,r.jsxs)("span",{className:"font-bold",children:["€ ",e.amount.toFixed(2)]})]},e.id))})]})]})}):(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center text-red-500",children:"Profilo non trovato"})}n(9135)},1822:function(e,t,n){"use strict";n.d(t,{Fl:function(){return c},ED:function(){return a},E$:function(){return i},T4:function(){return o},cp:function(){return s},gg:function(){return l}});let r=(0,n(8967).eI)("your_supabase_url","your_supabase_anon_key");async function s(){let{data:e,error:t}=await r.from("profiles").select("*").order("id");if(t)throw t;return e}async function a(e){let{name:t,avatar_url:n,color:s}=e,{data:a,error:l}=await r.from("profiles").insert([{name:t,avatar_url:n,color:s}]).select().single();if(l)throw l;return a}async function l(e,t){let{data:n,error:s}=await r.storage.from("avatars").upload(t,e,{upsert:!0});if(s)throw s;return n}function i(e){return r.storage.from("avatars").getPublicUrl(e).data.publicUrl}async function o(){let{data:e,error:t}=await r.from("expenses").select("*").order("date",{ascending:!1});if(t)throw t;return e}async function c(e){let{data:t,error:n}=await r.from("expenses").insert([e]).select().single();if(n)throw n;return t}},1163:function(e,t,n){e.exports=n(3079)}},function(e){e.O(0,[967,888,774,179],function(){return e(e.s=2494)}),_N_E=e.O()}]);