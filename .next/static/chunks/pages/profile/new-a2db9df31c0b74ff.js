(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[173],{1287:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile/new",function(){return r(9036)}])},9135:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var n=r(5893),a=r(7294),o=r(1822);function l(e){let{profileId:t,onUpload:r}=e,l=(0,a.useRef)(),[s,i]=(0,a.useState)(!1),[c,u]=(0,a.useState)(""),f=async e=>{let n=e.target.files[0];if(n){i(!0),u("");try{let e="".concat(t,"_").concat(Date.now());await (0,o.gg)(n,e);let a=(0,o.E$)(e);r(a)}catch(e){u("Errore upload foto")}finally{i(!1)}}};return(0,n.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,n.jsx)("input",{type:"file",accept:"image/*",ref:l,onChange:f,className:"hidden"}),(0,n.jsx)("button",{className:"px-3 py-1 bg-primary text-white rounded shadow hover:bg-primary/80",onClick:()=>l.current.click(),disabled:s,type:"button",children:s?"Caricamento...":"Carica foto profilo"}),c&&(0,n.jsx)("span",{className:"text-red-500 text-xs",children:c})]})}},9036:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return s}});var n=r(5893),a=r(7294),o=r(1822),l=r(9135);function s(){let[e,t]=(0,a.useState)(""),[r,s]=(0,a.useState)("#60a5fa"),[i,c]=(0,a.useState)(""),[u,f]=(0,a.useState)(!1),[d,p]=(0,a.useState)(""),x=async t=>{t.preventDefault(),f(!0),p("");try{let t=await (0,o.ED)({name:e,avatar_url:i,color:r});window.location.href="/profile/".concat(t.id)}catch(e){p("Errore nella creazione del profilo")}finally{f(!1)}};return(0,n.jsx)("main",{className:"min-h-screen flex flex-col items-center justify-center bg-background px-4 py-8",children:(0,n.jsxs)("form",{onSubmit:x,className:"w-full max-w-md mx-auto bg-white rounded-xl shadow p-6 flex flex-col gap-6",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-center",children:"Crea un nuovo profilo"}),(0,n.jsx)(l.Z,{profileId:e||"temp",onUpload:c}),i&&(0,n.jsx)("img",{src:i,alt:"avatar",className:"w-20 h-20 mx-auto rounded-full object-cover border"}),(0,n.jsx)("input",{type:"text",placeholder:"Nome",value:e,onChange:e=>t(e.target.value),className:"border rounded px-4 py-2 w-full focus:outline-none focus:ring focus:border-blue-400",required:!0}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{className:"text-sm",children:"Colore profilo:"}),(0,n.jsx)("input",{type:"color",value:r,onChange:e=>s(e.target.value)})]}),(0,n.jsx)("button",{type:"submit",className:"w-full py-3 rounded-xl bg-primary text-white font-bold text-lg shadow hover:bg-primary/90 transition",disabled:u,children:u?"Creazione...":"Crea profilo"}),d&&(0,n.jsx)("div",{className:"text-center text-red-500",children:d})]})})}},1822:function(e,t,r){"use strict";r.d(t,{Fl:function(){return c},ED:function(){return o},E$:function(){return s},T4:function(){return i},cp:function(){return a},gg:function(){return l}});let n=(0,r(8967).eI)("your_supabase_url","your_supabase_anon_key");async function a(){let{data:e,error:t}=await n.from("profiles").select("*").order("id");if(t)throw t;return e}async function o(e){let{name:t,avatar_url:r,color:a}=e,{data:o,error:l}=await n.from("profiles").insert([{name:t,avatar_url:r,color:a}]).select().single();if(l)throw l;return o}async function l(e,t){let{data:r,error:a}=await n.storage.from("avatars").upload(t,e,{upsert:!0});if(a)throw a;return r}function s(e){return n.storage.from("avatars").getPublicUrl(e).data.publicUrl}async function i(){let{data:e,error:t}=await n.from("expenses").select("*").order("date",{ascending:!1});if(t)throw t;return e}async function c(e){let{data:t,error:r}=await n.from("expenses").insert([e]).select().single();if(r)throw r;return t}}},function(e){e.O(0,[967,888,774,179],function(){return e(e.s=1287)}),_N_E=e.O()}]);